# 面部动作单元（AU）情绪分析总结报告

**分析日期**: 2026年2月17日  
**数据规模**: 27个数据文件，涵盖对照组与患者组  
**分析工具**: OpenFace 2.0 + Python数据分析（pandas, matplotlib, seaborn）

---

## 1. 分析数据文件介绍

### 1.1 数据来源
- **提取工具**: OpenFace 2.0 面部行为分析工具包
- **输出格式**: CSV文件，包含面部Action Units（AU）激活强度值
- **AU类型**: 17个动作单元（AU01_r ~ AU45_r）
- **采样频率**: 约30fps（每帧间隔0.033秒）
- **数据字段**: frame, face_id, timestamp, confidence, success, AU01_r~AU45_r（强度值）, AU01_c~AU45_c（存在/不存在标记）

### 1.2 数据规模
| 分组 | 数量 | 帧数范围 | 文件大小范围 |
|------|------|----------|--------------|
| 对照组 | 9文件 | 1,810~9,775帧 | 420K~2.3M |
| 男性患者 | 9文件 | 3,650~20,076帧 | 860K~4.7M |
| 女性患者 | 9文件 | 3,625~20,024帧 | 69K~4.7M |

**总数据量**: 约27万帧，涵盖9个被试×3种情绪条件

---

## 2. 数据分组说明

### 2.1 实验设计
- **被试类型**: 对照组（健康人）vs 患者组（抑郁症患者）
- **性别分布**: 男性（M）vs 女性（F）
- **情绪条件**: 悲伤、中性、积极（3种情绪诱发）
- **完整设计**: 3情绪 × 3患者 × 2性别 + 对照组 = 27个数据文件

### 2.2 文件映射表

#### 对照组（Control）
| 情绪 | M1 | M2 | F1 |
|------|-----|-----|-----|
| 悲伤 | file_3 | file_4 | file_5 |
| 中性 | file_18 | file_19 | file_20 |
| 积极 | file_21 | file_22 | file_23 |

#### 男性患者（Male Patients）
| 情绪 | M1 | M2 | M3 |
|------|-----|-----|-----|
| 悲伤 | file_27 | file_28 | file_29 |
| 中性 | file_30 | file_31 | file_32 |
| 积极 | file_24 | file_25 | file_26 |

#### 女性患者（Female Patients）
| 情绪 | F1 | F2 | F3 |
|------|-----|-----|-----|
| 中性 | file_33 ⚠️ | file_34 | file_35 |
| 积极 | file_36 | file_37 | file_38 |
| 悲伤 | file_39 | file_40 | file_41 |

---

## 3. 不同组合分析情况

### 3.1 已完成的分析模块

| 分析模块 | 输出文件数 | 关键发现 |
|----------|-----------|----------|
| **悲伤情绪性别对比** | 15+ | AU07（眼睑收紧）男性显著高于女性（1.64 vs 0.04） |
| **中性情绪性别对比** | 15+ | AU07持续男性优势（1.356 vs 0.018） |
| **积极情绪性别对比** | 15+ | AU04意外男性更高（1.01差异） |
| **跨情绪综合对比** | 20+ | 15个AU一致男性>女性，AU07是"性别差异之王" |
| **AU时间序列轨迹** | 10+ | 女性AU07在悲伤60秒后降至近零（习惯化/抑制） |
| **女性患者跨情绪分析** | 15+ | F1 AU04悲伤/积极双高，F3 AU12积极达1.05 |
| **男性患者跨情绪分析** | 15+ | M3习惯性皱眉贯穿所有情绪，M2表达最正常 |
| **患者-对照组悲伤对比（修正版）** | 5+ | 患者AU04/AU07/AU12显著降低，AU17升高 |

### 3.2 分析方法说明

#### 统计方法
- **描述统计**: 均值、标准差、分位数
- **效应量**: Cohen's d（标准化差异）
- **可视化**: 
  - AU激活热图（RdYlBu_r色图，居中于0）
  - 17×17 AU相关矩阵（RdBu_r色图，-1到1范围）
  - 组间差异条形图
  - 时间序列轨迹图

#### 数据预处理
- 列名清理：去除OpenFace CSV列名中的前导空格
- NaN处理：常数/零方差AU的相关性填充为0
- 数据对齐：不同长度时间序列通过子采样对齐

---

## 4. 初步结论

### 4.1 性别差异发现

| AU | 功能描述 | 性别差异方向 | 一致性 |
|----|----------|--------------|--------|
| **AU07** | 眼睑收紧 | 男 > 女 | **100%**（所有情绪） |
| **AU04** | 眉毛降低 | 男 > 女 | 中性/积极显著 |
| **AU12** | 嘴角上扬 | 男 > 女 | 积极情绪显著 |
| **AU06** | 脸颊提升 | 男 > 女 | 悲伤/中性显著 |

**核心结论**: 17个AU中15个显示男性激活高于女性，AU07是最稳定的性别差异标记（悲伤1.61、中性1.34、积极0.98）。

### 4.2 患者组特征（vs 对照组，悲伤情绪）

| AU | 对照组均值 | 男患者 | 女患者 | 差异方向 | 临床意义 |
|----|-----------|--------|--------|----------|----------|
| **AU04** | 1.43 | 0.88 ↓ | 0.39 ↓↓ | **显著降低** | 皱眉减少 |
| **AU07** | 1.20 | 0.78 ↓ | 0.10 ↓↓ | **显著降低** | 眼睑活动减少 |
| **AU12** | 0.83 | 0.21 ↓ | 0.24 ↓ | **显著降低** | 嘴角上扬减少 |
| **AU17** | 0.18 | 0.25 ↑ | 0.47 ↑↑ | **升高** | 下巴抬起增加 |
| **AU06** | 0.15 | 0.42 ↑ | 0.05 → | 男性升高 | 脸颊提升 |

**核心结论**: 抑郁症患者在悲伤情绪下表现出"低表达"特征（AU04/AU07/AU12降低），但AU17（下巴抬起）升高，可能反映不同的悲伤表达方式或情绪调节策略。

### 4.3 个体差异分析

#### 男性患者（M1/M2/M3）
| 患者 | 类型 | 特征描述 | 临床提示 |
|------|------|----------|----------|
| **M1** | 表达扁平型 | 各情绪AU激活差异小，AU06几乎无激活 | 可能存在情感表达抑制 |
| **M2** | 典型表达型 | 情绪-表情对应清晰，积极情绪AU06/AU07显著升高 | 情绪表达相对正常 |
| **M3** | 皱眉主导型 | AU04在所有情绪下均高（悲伤2.27、中性2.01、积极2.15） | **习惯性皱眉，可能存在情感表达障碍** |

#### 女性患者（F1/F2/F3）
| 患者 | 特征描述 | 异常标记 |
|------|----------|----------|
| **F1** | AU04在悲伤（0.73）和积极（0.66）均高 | 情绪特异性差 |
| **F2** | AU14在悲伤和积极均显著低于中性 | 嘴角酒窝减少 |
| **F3** | AU12在积极情绪达1.05（最高） | 笑容表达较好 |

---

## 5. 样本数据问题

### 5.1 已识别的数据质量问题

| 问题文件 | 问题描述 | 影响 | 处理状态 |
|----------|----------|------|----------|
| **file_33** | F1-中性仅294帧（约10秒） | 数据量不足，统计代表性差 | **已搁置** |
| **file_5 vs file_39-41** | 悲伤情绪对照组vs患者组帧数差异大 | 时间序列对齐需子采样 | 已处理 |
| **M3所有情绪** | AU04持续高激活（2.0+） | 可能为习惯性皱眉而非情绪反应 | 需临床确认 |

### 5.2 数据收集建议
- **时长标准化**: 建议所有视频片段统一为60-90秒
- **质量检查**: 上传前确认帧数>1000（约30秒以上）
- **校准验证**: 中性情绪下AU应接近基线水平，用于识别异常被试

---

## 6. 临床意义初步解读

### 6.1 抑郁症面部表情的可能标记
1. **AU04降低** - 与典型抑郁症"愁眉苦脸"刻板印象相反，患者皱眉减少
2. **AU07降低** - 眼睑活动减少，可能反映"目光呆滞"或情感迟钝
3. **AU12降低** - 自发笑容减少，符合抑郁症正性情绪体验降低
4. **AU17升高** - 下巴抬起增加，可能为努力控制情绪的代偿表现

### 6.2 性别特异性表现
- 男性患者保留更多AU06（脸颊提升）激活
- 女性患者AU07降低更显著（悲伤情绪0.10 vs 对照组1.20）

---

## 7. 后续分析建议

### 7.1 建议完成的分析
- [ ] **全数据矩阵3×3×2分析**: 完整的情绪×患者×性别交互效应
- [ ] **时间序列分类器**: 基于AU轨迹的抑郁状态自动识别
- [ ] ** mediation分析**: 情绪诱发→AU激活→抑郁严重度的中介模型
- [ ] **对照组-患者组中性/积极对比**: 目前仅完成悲伤对比

### 7.2 方法学建议
- 考虑使用Bootstrap方法处理小样本问题
- 引入FDR多重比较校正
- 探索机器学习分类器（SVM/Random Forest）区分患者/对照

---

## 8. 分析产出清单

### 生成的分析脚本（15个，已清理旧版）

#### 核心分析脚本（8个）
1. `analyze_sadness_reorganized.py` - 悲伤情绪性别对比
2. `analyze_neutral_reorganized.py` - 中性情绪性别对比
3. `analyze_positive_reorganized.py` - 积极情绪性别对比
4. `cross_emotion_analysis.py` - 跨情绪综合对比
5. `au_time_series_v2.py` - AU时间序列轨迹（修正版）
6. `analyze_female_patients_cross_emotion.py` - 女性患者跨情绪
7. `analyze_male_patients_cross_emotion.py` - 男性患者跨情绪
8. `analyze_patient_control_sadness_corrected.py` - 患者-对照组对比（修正版）

#### 面部活动性与高级分析（2个）
9. `calculate_facial_activity_index.py` - 面部活动性指数（AD方案核心指标）
10. `ad_mediation_analysis.py` - 中介效应分析框架

#### 相关矩阵生成（4个）
11. `generate_correlation_heatmaps.py` - AU相关矩阵生成
12. `generate_female_correlation_heatmaps.py` - 女性患者相关矩阵
13. `generate_neutral_correlation_heatmaps.py` - 中性情绪相关矩阵
14. `generate_positive_correlation_heatmaps.py` - 积极情绪相关矩阵

#### 工具脚本（1个）
15. `data_visualization.py` - 通用数据可视化

### 生成的结果目录（10个，已清理旧版错误结果）

#### 基础情绪对比（3个）
- `2025-02-17_悲伤情绪_2M1F对比/` - 悲伤情绪2M+1F对比
- `2025-02-17_中性情绪_2M1F对比/` - 中性情绪2M+1F对比
- `2026-02-17_积极情绪_性别对比/` - 积极情绪2M+1F对比

#### 跨情绪与患者分析（4个）
- `2026-02-17_跨情绪综合对比/` - 三情绪综合对比分析
- `2026-02-17_AU时间轨迹分析_v2/` - 时间序列轨迹（修正版）
- `2026-02-17_女性患者跨情绪分析/` - F1/F2/F3跨情绪
- `2026-02-17_男性患者跨情绪分析/` - M1/M2/M3跨情绪

#### 患者对照与AD指标（2个）
- `2026-02-17_患者对照组对比_悲伤情绪_修正版/` - 修正版患者vs对照
- `2026-02-17_面部活动性指数分析/` - AD方案面部活动性指标

#### 总结报告（1个）
- `总结报告/` - 完整分析总结

---

## 9. 后续推进建议（参照AD研究方案框架）

基于阿尔茨海默病面部微表情研究方案（两阶段设计），结合当前抑郁症数据分析基础，提出以下推进路径：

### 9.1 第一阶段完善：行为验证深化（当前数据可完成）

#### 9.1.1 核心指标补充计算：面部活动性指数

参照AD方案，计算"面部活动性"作为情感淡漠的客观指标：

```
面部活动性 = Σ(所有AU激活值) / 时间窗口
```

**建议计算维度**：
| 指标类型 | 计算方法 | 临床意义 |
|----------|----------|----------|
| **总体面部活动性** | 全时段AU总和/总时长 | 整体情感表达丰富度 |
| **情绪特异性活动性** | 悲伤/中性/积极分别计算 | 情绪调节能力 |
| **动态活动性衰减** | 滑动窗口（30s）计算 | 情感 habituation/抑制 |
| **AU协同激活复杂度** | 不同AU共现频率 | 面部表情动态复杂度 |

**预期结果**：患者组总体面部活动性显著低于对照组，且随时间衰减更快。

#### 9.1.2 患者亚型分类（基于现有数据）

参照M1/M2/M3分类模式，建立抑郁症患者AU表达分型：

| 亚型 | 特征 | 占比预估 | 对应患者 |
|------|------|----------|----------|
| **表达扁平型** | 各情绪AU差异<0.3，AU06持续<0.1 | ~33% | M1 |
| **典型表达型** | 情绪-AU对应清晰，积极AU06>1.0 | ~33% | M2 |
| **皱眉主导型** | AU04>1.5贯穿所有情绪 | ~33% | M3 |
| **低眼睑活动型** | AU07<0.2，女性为主 | ~50% | F1/F2/F3 |

**临床价值**：不同亚型可能对应不同治疗反应（如皱眉主导型可能对肉毒素注射+抗抑郁药联合治疗反应更好）。

### 9.2 第二阶段准备：神经机制探索（需补充数据）

#### 9.2.1 中介效应分析框架（方法论已就绪）

已准备`ad_mediation_analysis.py`脚本，可执行Bootstrap中介分析。

**行为层面中介模型**（当前数据可尝试）：
```
抑郁严重程度(HAMD总分) → AU特征(AU07降低) → 社交功能评分(SAS)
```

**理想中介模型**（需影像数据）：
```
抑郁严重程度(HAMD) → 杏仁核功能连接降低 → 面部活动性降低 → 社会功能损害
```

**数据需求**：
| 变量类型 | 当前状态 | 需求 | 获取方式 |
|----------|----------|------|----------|
| 自变量：疾病严重程度 | ❌ | HAMD/HAMA总分 | 临床量表 |
| 中介变量：脑功能 | ❌ | 杏仁核体积/rsFC | MRI扫描 |
| 因变量：面部活动性 | ✅ | 可从现有数据计算 | 已完成 |
| 协变量 | ⚠️ | 年龄/性别/教育 | 需确认匹配 |

#### 9.2.2 当前样本 vs AD方案要求对比

| AD方案要求 | 当前状态 | 差距分析 | 优先级 |
|------------|----------|----------|--------|
| 轻/中/重度分组 | 未明确分期 | 需补充HAMD评分 | ⭐⭐⭐ 高 |
| n≥20每组 | 对照3+患者6 | 需扩大样本 | ⭐⭐ 中 |
| 年龄/性别/教育匹配 | 部分满足 | 需确认匹配情况 | ⭐⭐ 中 |
| 标准化视频采集 | ✅ 满足 | - | - |
| 多模态MRI | ❌ 无 | 需申请影像合作 | ⭐ 低（第二阶段） |

### 9.3 即时可执行任务清单

#### 🔴 今天可完成（1-2天）

- [ ] **计算面部活动性综合指标**
  - 脚本：`calculate_facial_activity_index.py`
  - 输出：患者vs对照组活动性对比表
  - 预期：患者组降低30%以上

- [ ] **按AD方案格式撰写第一阶段报告**
  - 结构：研究目标/被试分组/数据采集/分析结果/初步结论
  - 产出：可用于课题汇报/论文方法学的完整文档

#### 🟡 本周可完成（需量表数据）

- [ ] **AU-临床量表相关性分析**
  - 需数据：HAMD、SDS、病程、社会功能评分
  - 分析方法：Pearson/Spearman相关 + 偏相关（控制年龄/性别）
  - 预期产出：相关系数热图 + 散点图

- [ ] **建立患者AU表达分型标准**
  - 基于M1/M2/M3模式，制定可量化的分型算法
  - 验证：不同亚型在症状严重度上是否存在差异

#### 🟢 下一步数据收集建议

- [ ] **补充核心量表数据**（优先级最高）
  - 必测：HAMD-17/24、SDS、病程、用药史
  - 选测：HAMA、MMSE、社会功能缺陷筛选量表

- [ ] **样本量扩大**（如需统计效力）
  - 目标：对照组n≥25，患者组n≥20（轻/中/重度分层）
  - 当前缺口：对照组+22，患者组+14，且需明确临床分期

- [ ] **视频质量标准化**
  - 统一时长：60-90秒/片段
  - 质控标准：帧数>1800，confidence>0.8比例>90%

### 9.4 数据分析脚本准备清单

| 脚本名称 | 功能 | 状态 | 复用来源 |
|----------|------|------|----------|
| `calculate_facial_activity_index.py` | 计算面部活动性综合指标 | 📝 待创建 | AD方案 |
| `au_scale_correlation.py` | AU特征与量表评分相关 | 📝 待创建 | 自定义 |
| `patient_subtyping.py` | 基于AU模式的患者分型 | 📝 待创建 | M1/M2/M3分类 |
| `ad_mediation_analysis.py` | 中介效应分析 | ✅ 已完成 | 已生成 |
| `fdr_correction.py` | 多重比较校正 | 📝 待创建 | 方法学需求 |
| `ml_classifier.py` | 患者/对照分类模型 | 📝 待创建 | 扩展分析 |

### 9.5 预期产出时间表

| 时间节点 | 产出 | 用途 |
|----------|------|------|
| **第1-2天** | 面部活动性分析报告 | 补充核心指标 |
| **第3-7天** | 第一阶段完整研究报告 | 课题汇报/基金申请 |
| **第2-4周** | 量表数据整合后相关性分析 | 论文核心结果 |
| **第1-3月** | 样本扩大后验证分析 | 提升统计效力 |
| **第3-6月** | 如获MRI数据，中介效应分析 | 神经机制探索 |

---

## 10. 核心结论与科学假说

### 10.1 已验证的发现
1. **性别差异稳定性**：AU07（眼睑收紧）是男性>女性的最稳定标记（100%一致性）
2. **患者低表达特征**：抑郁症患者AU04/AU07/AU12显著降低，AU17代偿性升高
3. **个体差异显著**：存在"表达扁平型"、"典型表达型"、"皱眉主导型"三种亚型

### 10.2 待验证的科学假说
1. **主假说**：抑郁症患者面部活动性指数与HAMD评分呈负相关（r<-0.5）
2. **中介假说**：杏仁核功能连接降低 → 面部活动性降低 → 社会功能损害
3. **分型假说**：不同AU表达亚型对应不同治疗反应和预后

---

---

## 附录：数据清理记录

### 已删除的旧版/错误脚本（9个）
以下脚本因版本过时或基于错误数据映射，已删除：

| 脚本名称 | 删除原因 | 替代脚本 |
|----------|----------|----------|
| `analyze_sadness_fixed.py` | 旧版，功能已被取代 | `analyze_sadness_reorganized.py` |
| `analyze_sadness_gender.py` | 旧版，功能已被取代 | `analyze_sadness_reorganized.py` |
| `analyze_positive_simple.py` | 简化版，功能不完整 | `analyze_positive_reorganized.py` |
| `au_time_series_analysis.py` | 旧版，存在列名处理问题 | `au_time_series_v2.py` |
| `cross_emotion_patient_analysis.py` | 旧版，功能已被取代 | `cross_emotion_analysis.py` |
| `patient_control_comparison.py` | **错误版本**，文件映射错误 | `analyze_patient_control_sadness_corrected.py` |
| `three_emotion_analysis.py` | 早期版本 | `cross_emotion_analysis.py` |
| `generate_positive_corr_simple.py` | 简化版 | `generate_positive_correlation_heatmaps.py` |
| `generate_separate_plots.py` | 早期版本 | 各`analyze_*.py` |

### 已删除的旧版/错误结果目录（4个）
以下结果目录因基于错误分析脚本或已被新版取代，已删除：

| 目录名称 | 删除原因 | 替代目录 |
|----------|----------|----------|
| `2026-02-17_AU时间轨迹分析/` | 旧版，列名处理问题 | `2026-02-17_AU时间轨迹分析_v2/` |
| `2026-02-17_患者对照组对比/` | **错误版本**，文件映射错误 | `2026-02-17_患者对照组对比_悲伤情绪_修正版/` |
| `2026-02-17_患者对照组对比_悲伤情绪/` | **错误版本**，文件映射错误 | `2026-02-17_患者对照组对比_悲伤情绪_修正版/` |
| `2026-02-17_跨情绪患者分析/` | 旧版，功能已被取代 | `analyze_female/male_patients_cross_emotion.py` 输出 |

### 已重命名的结果目录（1个）
| 原目录名称 | 新目录名称 | 说明 |
|------------|------------|------|
| `2025-02-17_AU_emotion_analysis/` | `2025-02-17_M1_三种情绪对比/` | M1对照组三情绪对比分析 |

### 修正历史
- **2026-02-17 21:20**: 发现并修正文件映射错误，重新分析患者-对照组对比
- **2026-02-17 21:25**: 清理9个旧版脚本，保留15个有效脚本
- **2026-02-17 21:26**: 清理5个旧版/错误结果目录，保留10个有效结果目录

---

**报告生成时间**: 2026年2月17日  
**分析师**: 超级小龙虾 🦞  
**版本**: v2.1（已清理旧版脚本和错误结果）
